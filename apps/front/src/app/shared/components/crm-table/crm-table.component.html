    <div class="crm-table">
      <div class="crm-table-toolbar" *ngIf="title || getTemplate('tableTitleTemplate')">
        <div class="crm-table-title">
          <ng-container *ngIf="title">{{ title }}</ng-container>
          <ng-container *ngIf="!title && getTemplate('tableTitleTemplate')">
            <ng-container *ngTemplateOutlet="getTemplate('tableTitleTemplate')"></ng-container>
          </ng-container>
        </div>
        <div class="crm-table-actions">
          <button mat-icon-button *ngIf="loading | async" aria-label="loading">
            <mat-progress-spinner
              diameter="20"
              mode="indeterminate"
            ></mat-progress-spinner>
          </button>
        </div>
      </div>

      <table
        mat-table
        [dataSource]="pagedData"
        matSort
        class="mat-elevation-z1 crm-deals-table deals-style"
      >
        <ng-container matColumnDef="select" *ngIf="selectable">
          <th mat-header-cell *matHeaderCellDef style="width:48px">
            <mat-checkbox
              (change)="toggleAll($event)"
              [checked]="allSelected"
            ></mat-checkbox>
          </th>
          <td mat-cell *matCellDef="let row" style="width:48px">
            <mat-checkbox
              (change)="toggleRow(row, $event)"
              [checked]="isSelected(row)"
            ></mat-checkbox>
          </td>
        </ng-container>


            <!-- Allow projected templates for column cells -->
            <ng-content></ng-content>

        <ng-container *ngFor="let col of columns" [matColumnDef]="col.key">
          <th
            mat-header-cell
            *matHeaderCellDef
            [style.width]="col.width || null"
          >
            <div class="th-wrap">
              <span class="th-label">{{ col.label }}</span>
              <button
                *ngIf="col.sortable"
                class="th-sort"
                (click)="$event.stopPropagation()"
              >
                <mat-icon class="sort-icon">unfold_more</mat-icon>
              </button>
            </div>
          </th>
          <td mat-cell *matCellDef="let row">
            <div class="cell-wrap">
              <ng-container *ngIf="!col.template">
                {{ renderCell(row, col) }}
              </ng-container>
              <ng-container *ngIf="col.template">
                <ng-container
                  *ngTemplateOutlet="getTemplate(col.template); context: { $implicit: row, column: col }"
                ></ng-container>
              </ng-container>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"
          (click)="onRowClick(row)"
        ></tr>
      </table>

      <div class="crm-table-footer">
        <mat-paginator
          *ngIf="showPaginator"
          [length]="total"
          [pageSize]="pageSize"
          [pageSizeOptions]="pageSizeOptions"
          (page)="onPage($event)"
        ></mat-paginator>
      </div>
    </div>
