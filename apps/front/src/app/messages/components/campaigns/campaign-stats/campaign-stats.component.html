<app-page-layout
  [title]="'Статистика кампании #' + campaignId()"
  subtitle="Подробная аналитика по выполнению кампании"
>
  <div page-actions>
    <button mat-stroked-button routerLink="/notifications/campaigns">
      <mat-icon>arrow_back</mat-icon>
      К списку
    </button>
    <button mat-raised-button color="primary">
      <mat-icon>download</mat-icon>
      Экспорт
    </button>
  </div>

  <div class="stats-grid">
    <mat-card class="stat-card">
      <div class="stat-icon primary">
        <mat-icon>send</mat-icon>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ stats().sent }}</div>
        <div class="stat-label">Отправлено</div>
      </div>
    </mat-card>

    <mat-card class="stat-card">
      <div class="stat-icon success">
        <mat-icon>check_circle</mat-icon>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ stats().delivered }}</div>
        <div class="stat-label">Доставлено</div>
        <div class="stat-percent">{{ stats().deliveryRate }}%</div>
      </div>
    </mat-card>

    <mat-card class="stat-card">
      <div class="stat-icon warning">
        <mat-icon>error</mat-icon>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ stats().failed }}</div>
        <div class="stat-label">Ошибки</div>
        <div class="stat-percent">{{ 100 - stats().deliveryRate }}%</div>
      </div>
    </mat-card>

    <mat-card class="stat-card">
      <div class="stat-icon accent">
        <mat-icon>trending_up</mat-icon>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ stats().deliveryRate }}%</div>
        <div class="stat-label">Доставляемость</div>
      </div>
    </mat-card>
  </div>

  <mat-card class="progress-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>show_chart</mat-icon>
        Прогресс отправки
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="progress-info">
        <span class="progress-label">{{ stats().sent }} из {{ stats().total }}</span>
        <span class="progress-percent">{{ progressPercent() }}%</span>
      </div>
      <mat-progress-bar 
        mode="determinate" 
        [value]="progressPercent()"
        class="progress-bar-large">
      </mat-progress-bar>
    </mat-card-content>
  </mat-card>

  <div class="charts-grid">
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>bar_chart</mat-icon>
          График отправок по времени
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-placeholder">
          <mat-icon>insert_chart</mat-icon>
          <p>График будет добавлен позже</p>
          <small>Интеграция с Chart.js или ngx-charts</small>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>pie_chart</mat-icon>
          Распределение статусов
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-placeholder">
          <mat-icon>donut_small</mat-icon>
          <p>Круговая диаграмма</p>
          <small>Доставлено vs Ошибки</small>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <mat-card class="details-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>info</mat-icon>
        Детали кампании
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="details-grid">
        <div class="detail-item">
          <span class="detail-label">Название:</span>
          <span class="detail-value">Летняя распродажа 2025</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Канал:</span>
          <span class="detail-value">SMS</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Запущено:</span>
          <span class="detail-value">{{ stats().startedAt || 'Не запущено' }}</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Завершено:</span>
          <span class="detail-value">{{ stats().completedAt || 'В процессе' }}</span>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</app-page-layout>
