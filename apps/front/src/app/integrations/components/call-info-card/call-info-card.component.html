<div class="call-info-container">
  <div *ngIf="loading()" class="loading-shade">
    <mat-spinner diameter="40"></mat-spinner>
  </div>

  <div *ngIf="error()" class="error-message">
    {{ error() }}
  </div>

  <div
    *ngIf="callInfo() as info"
    class="info-content"
  >
   
    <!-- Динамические секции -->
    <mat-tab-group *ngIf="info.sections?.length" dynamicHeight>
      <mat-tab *ngFor="let section of info.sections" [label]="section.ui.title">
        <div class="section-content p-4">
          <!-- Просмотр — детали -->
          <div *ngIf="section.ui.type === 'details'" class="details-grid">
            <div *ngFor="let field of section.ui.fields" class="detail-item">
              <span class="detail-label">{{ field.label }}</span>
              <span class="detail-value">{{ section.data[field.key] }}</span>
            </div>
          </div>

          <!-- Табличный вид -->
          <div *ngIf="section.ui.type === 'table'" class="table-container">
            <table mat-table [dataSource]="section.data" class="w-full">
              <ng-container
                *ngFor="let col of section.ui.columns"
                [matColumnDef]="col.key"
              >
                <th mat-header-cell *matHeaderCellDef>{{ col.label }}</th>
                <td mat-cell *matCellDef="let element">
                  {{ element[col.key] }}
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="getColumns(section)"></tr>
              <tr
                mat-row
                *matRowDef="let row; columns: getColumns(section)"
              ></tr>
            </table>

            <div
              *ngIf="!section.data?.length"
              class="p-4 text-center text-gray-500"
            >
              Нет данных
            </div>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
