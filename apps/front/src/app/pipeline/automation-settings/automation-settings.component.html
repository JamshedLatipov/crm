<div class="automation-settings">
  <div class="modal-header">
    <h2 mat-dialog-title>
      <mat-icon>settings</mat-icon>
      Автоматизация воронки продаж
    </h2>
    <button mat-icon-button [mat-dialog-close]="false" class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <div mat-dialog-content class="modal-content">
    <div class="content-grid">
      <!-- Левая колонка - список правил -->
      <app-automation-rules-list
        [rules]="rules()"
        [isLoading]="isLoading()"
        [selectedRule]="selectedRule()"
        (selectRule)="selectRule($event)"
        (toggleRule)="toggleRule($event)"
        (createNewRule)="createNewRule()">
      </app-automation-rules-list>

      <!-- Правая колонка - редактор правила -->
      <app-automation-rule-editor
        [selectedRule]="selectedRule()"
        [isEditingNew]="isEditingNew()"
        [stages]="stages()"
        [newRule]="newRule"
        (cancelEdit)="cancelEdit()"
        (createRule)="createRule($event)"
        (updateRule)="updateRule($event)"
        (addCondition)="addCondition()"
        (removeCondition)="removeCondition($event)"
        (addAction)="addAction()"
        (removeAction)="removeAction($event)"
        (onConditionFieldChange)="onConditionFieldChange($event)"
        (createNewRule)="createNewRule()">
      </app-automation-rule-editor>
    </div>
  </div>

  <div mat-dialog-actions class="modal-actions">
    <button mat-button [mat-dialog-close]="false">Закрыть</button>
    <button mat-raised-button color="primary" (click)="triggerAutomation()">
      <mat-icon>play_arrow</mat-icon>
      Запустить автоматизацию
    </button>
  </div>
</div>