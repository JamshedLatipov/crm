<h2 mat-dialog-title>Добавить участника в очередь</h2>
<mat-dialog-content>
  <div class="add-member-form">
    <mat-form-field appearance="outline" style="width: 100%; margin-bottom: 16px;">
      <mat-label>Выберите пользователя</mat-label>
      <mat-select [formControl]="userControl">
        <mat-option [value]="null">-- Кастомный участник (ручной ввод) --</mat-option>
        <mat-option *ngIf="isLoading" disabled>
          <div style="display: flex; align-items: center; gap: 8px;">
            <mat-spinner diameter="18"></mat-spinner>
            <span>Загрузка пользователей...</span>
          </div>
        </mat-option>
        <mat-option *ngFor="let user of users" [value]="user">
          <div style="display: flex; flex-direction: column;">
            <div style="font-weight: 500;">{{ user.name }}</div>
            <div style="font-size: 12px; color: #666;">
              {{ user.email }}
              <span *ngIf="user.sipEndpointId">• SIP: {{ user.sipEndpointId }}</span>
            </div>
          </div>
        </mat-option>
      </mat-select>
      <mat-icon matSuffix>person</mat-icon>
      <mat-hint>Выберите пользователя из списка или оставьте пустым для ручного ввода</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" style="width: 100%; margin-bottom: 16px;">
      <mat-label>Интерфейс участника</mat-label>
      <input matInput [formControl]="interfaceControl" placeholder="например, PJSIP/1001 или operator1" required />
      <mat-icon matSuffix>phone</mat-icon>
      <mat-hint>{{ userControl.value ? 'Заполняется из SIP интерфейса пользователя (например 1001)' : 'Введите интерфейс вручную (например 1001 или PJSIP/1001)' }}</mat-hint>
      <mat-error *ngIf="interfaceControl.hasError('required')">Укажите интерфейс</mat-error>
    </mat-form-field>
  </div>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button (click)="cancel()">Отмена</button>
  <button mat-raised-button color="primary" (click)="save()" [disabled]="!isValid()">Добавить</button>
</mat-dialog-actions>
